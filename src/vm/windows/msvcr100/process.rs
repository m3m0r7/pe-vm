//! Process/thread function stubs for MSVCR100.dll.
#![allow(dead_code, non_snake_case)]

use crate::vm::Vm;

const DLL: &str = "MSVCR100.dll";

// Process functions
define_stub_fn!(DLL, getpid_impl, 0);
define_stub_fn!(DLL, execl_impl, 0);
define_stub_fn!(DLL, execle_impl, 0);
define_stub_fn!(DLL, execlp_impl, 0);
define_stub_fn!(DLL, execlpe_impl, 0);
define_stub_fn!(DLL, execv_impl, 0);
define_stub_fn!(DLL, execve_impl, 0);
define_stub_fn!(DLL, execvp_impl, 0);
define_stub_fn!(DLL, execvpe_impl, 0);
define_stub_fn!(DLL, wexecl_impl, 0);
define_stub_fn!(DLL, wexecle_impl, 0);
define_stub_fn!(DLL, wexeclp_impl, 0);
define_stub_fn!(DLL, wexeclpe_impl, 0);
define_stub_fn!(DLL, wexecv_impl, 0);
define_stub_fn!(DLL, wexecve_impl, 0);
define_stub_fn!(DLL, wexecvp_impl, 0);
define_stub_fn!(DLL, wexecvpe_impl, 0);
define_stub_fn!(DLL, spawnl_impl, 0);
define_stub_fn!(DLL, spawnle_impl, 0);
define_stub_fn!(DLL, spawnlp_impl, 0);
define_stub_fn!(DLL, spawnlpe_impl, 0);
define_stub_fn!(DLL, spawnv_impl, 0);
define_stub_fn!(DLL, spawnve_impl, 0);
define_stub_fn!(DLL, spawnvp_impl, 0);
define_stub_fn!(DLL, spawnvpe_impl, 0);
define_stub_fn!(DLL, wspawnl_impl, 0);
define_stub_fn!(DLL, wspawnle_impl, 0);
define_stub_fn!(DLL, wspawnlp_impl, 0);
define_stub_fn!(DLL, wspawnlpe_impl, 0);
define_stub_fn!(DLL, wspawnv_impl, 0);
define_stub_fn!(DLL, wspawnve_impl, 0);
define_stub_fn!(DLL, wspawnvp_impl, 0);
define_stub_fn!(DLL, wspawnvpe_impl, 0);
define_stub_fn!(DLL, cwait_impl, 0);
define_stub_fn!(DLL, popen_impl, 0);
define_stub_fn!(DLL, wpopen_impl, 0);
define_stub_fn!(DLL, pclose_impl, 0);
define_stub_fn!(DLL, loaddll_impl, 0);
define_stub_fn!(DLL, unloaddll_impl, 0);
define_stub_fn!(DLL, getdllprocaddr_impl, 0);
define_stub_fn!(DLL, beep_impl, 0);
define_stub_fn!(DLL, sleep_impl, 0);

// Thread functions
define_stub_fn!(DLL, beginthread_impl, 0);
define_stub_fn!(DLL, beginthreadex_impl, 0);
define_stub_fn!(DLL, endthread_impl, 0);
define_stub_fn!(DLL, endthreadex_impl, 0);
define_stub_fn!(DLL, threadhandle_impl, 0);
define_stub_fn!(DLL, threadid_impl, 0);

// Global variables
define_stub_fn!(DLL, argc, 0);
define_stub_fn!(DLL, argv, 0);
define_stub_fn!(DLL, wargv, 0);
define_stub_fn!(DLL, environ, 0);
define_stub_fn!(DLL, wenviron, 0);
define_stub_fn!(DLL, pgmptr, 0);
define_stub_fn!(DLL, wpgmptr, 0);
define_stub_fn!(DLL, acmdln, 0);
define_stub_fn!(DLL, wcmdln, 0);
define_stub_fn!(DLL, initenv, 0);
define_stub_fn!(DLL, winitenv, 0);
define_stub_fn!(DLL, commode, 0);
define_stub_fn!(DLL, fmode, 0);
define_stub_fn!(DLL, osplatform, 0);
define_stub_fn!(DLL, osver, 0);
define_stub_fn!(DLL, winver, 0);
define_stub_fn!(DLL, winmajor, 0);
define_stub_fn!(DLL, winminor, 0);
define_stub_fn!(DLL, fls_getvalue, 0);
define_stub_fn!(DLL, fls_setvalue, 0);
define_stub_fn!(DLL, set_app_type, 0);
define_stub_fn!(DLL, set_flsgetvalue, 0);
define_stub_fn!(DLL, get_flsindex, 0);
define_stub_fn!(DLL, get_tlsindex, 0);
define_stub_fn!(DLL, getmainargs, 0);
define_stub_fn!(DLL, wgetmainargs, 0);
define_stub_fn!(DLL, configure_narrow_argv, 0);
define_stub_fn!(DLL, configure_wide_argv, 0);
define_stub_fn!(DLL, crt_rtc_init, 0);
define_stub_fn!(DLL, crt_rtc_initw, 0);
define_stub_fn!(DLL, report_gsfailure, 0);
define_stub_fn!(DLL, get_osplatform, 0);
define_stub_fn!(DLL, get_osver, 0);
define_stub_fn!(DLL, get_winver, 0);
define_stub_fn!(DLL, get_winmajor, 0);
define_stub_fn!(DLL, get_winminor, 0);
define_stub_fn!(DLL, unDName, 0);
define_stub_fn!(DLL, unDNameEx, 0);
define_stub_fn!(DLL, unDNameHelper, 0);

pub fn register(vm: &mut Vm) {
    // Process functions
    vm.register_import(DLL, "_getpid", getpid_impl);
    vm.register_import(DLL, "_execl", execl_impl);
    vm.register_import(DLL, "_execle", execle_impl);
    vm.register_import(DLL, "_execlp", execlp_impl);
    vm.register_import(DLL, "_execlpe", execlpe_impl);
    vm.register_import(DLL, "_execv", execv_impl);
    vm.register_import(DLL, "_execve", execve_impl);
    vm.register_import(DLL, "_execvp", execvp_impl);
    vm.register_import(DLL, "_execvpe", execvpe_impl);
    vm.register_import(DLL, "_wexecl", wexecl_impl);
    vm.register_import(DLL, "_wexecle", wexecle_impl);
    vm.register_import(DLL, "_wexeclp", wexeclp_impl);
    vm.register_import(DLL, "_wexeclpe", wexeclpe_impl);
    vm.register_import(DLL, "_wexecv", wexecv_impl);
    vm.register_import(DLL, "_wexecve", wexecve_impl);
    vm.register_import(DLL, "_wexecvp", wexecvp_impl);
    vm.register_import(DLL, "_wexecvpe", wexecvpe_impl);
    vm.register_import(DLL, "_spawnl", spawnl_impl);
    vm.register_import(DLL, "_spawnle", spawnle_impl);
    vm.register_import(DLL, "_spawnlp", spawnlp_impl);
    vm.register_import(DLL, "_spawnlpe", spawnlpe_impl);
    vm.register_import(DLL, "_spawnv", spawnv_impl);
    vm.register_import(DLL, "_spawnve", spawnve_impl);
    vm.register_import(DLL, "_spawnvp", spawnvp_impl);
    vm.register_import(DLL, "_spawnvpe", spawnvpe_impl);
    vm.register_import(DLL, "_wspawnl", wspawnl_impl);
    vm.register_import(DLL, "_wspawnle", wspawnle_impl);
    vm.register_import(DLL, "_wspawnlp", wspawnlp_impl);
    vm.register_import(DLL, "_wspawnlpe", wspawnlpe_impl);
    vm.register_import(DLL, "_wspawnv", wspawnv_impl);
    vm.register_import(DLL, "_wspawnve", wspawnve_impl);
    vm.register_import(DLL, "_wspawnvp", wspawnvp_impl);
    vm.register_import(DLL, "_wspawnvpe", wspawnvpe_impl);
    vm.register_import(DLL, "_cwait", cwait_impl);
    vm.register_import(DLL, "_popen", popen_impl);
    vm.register_import(DLL, "_wpopen", wpopen_impl);
    vm.register_import(DLL, "_pclose", pclose_impl);
    vm.register_import(DLL, "_loaddll", loaddll_impl);
    vm.register_import(DLL, "_unloaddll", unloaddll_impl);
    vm.register_import(DLL, "_getdllprocaddr", getdllprocaddr_impl);
    vm.register_import(DLL, "_beep", beep_impl);
    vm.register_import(DLL, "_sleep", sleep_impl);

    // Thread functions
    vm.register_import(DLL, "_beginthread", beginthread_impl);
    vm.register_import(DLL, "_beginthreadex", beginthreadex_impl);
    vm.register_import(DLL, "_endthread", endthread_impl);
    vm.register_import(DLL, "_endthreadex", endthreadex_impl);
    vm.register_import(DLL, "__threadhandle", threadhandle_impl);
    vm.register_import(DLL, "__threadid", threadid_impl);

    // Global variables
    vm.register_import(DLL, "__argc", argc);
    vm.register_import(DLL, "__argv", argv);
    vm.register_import(DLL, "__wargv", wargv);
    vm.register_import(DLL, "_environ", environ);
    vm.register_import(DLL, "_wenviron", wenviron);
    vm.register_import(DLL, "_pgmptr", pgmptr);
    vm.register_import(DLL, "_wpgmptr", wpgmptr);
    vm.register_import(DLL, "_acmdln", acmdln);
    vm.register_import(DLL, "_wcmdln", wcmdln);
    vm.register_import(DLL, "__initenv", initenv);
    vm.register_import(DLL, "__winitenv", winitenv);
    vm.register_import(DLL, "_commode", commode);
    vm.register_import(DLL, "_fmode", fmode);
    vm.register_import(DLL, "__p___argc", argc);
    vm.register_import(DLL, "__p___argv", argv);
    vm.register_import(DLL, "__p___wargv", wargv);
    vm.register_import(DLL, "__p__environ", environ);
    vm.register_import(DLL, "__p__wenviron", wenviron);
    vm.register_import(DLL, "__p__pgmptr", pgmptr);
    vm.register_import(DLL, "__p__wpgmptr", wpgmptr);
    vm.register_import(DLL, "__p__acmdln", acmdln);
    vm.register_import(DLL, "__p__wcmdln", wcmdln);
    vm.register_import(DLL, "__p___initenv", initenv);
    vm.register_import(DLL, "__p___winitenv", winitenv);
    vm.register_import(DLL, "__p__commode", commode);
    vm.register_import(DLL, "__p__fmode", fmode);
    vm.register_import(DLL, "__p___mb_cur_max", argc);
    vm.register_import(DLL, "___fls_getvalue@4", fls_getvalue);
    vm.register_import(DLL, "___fls_setvalue@8", fls_setvalue);
    vm.register_import(DLL, "__set_app_type", set_app_type);
    vm.register_import(DLL, "__set_flsgetvalue", set_flsgetvalue);
    vm.register_import(DLL, "__get_flsindex", get_flsindex);
    vm.register_import(DLL, "__get_tlsindex", get_tlsindex);
    vm.register_import(DLL, "__getmainargs", getmainargs);
    vm.register_import(DLL, "__wgetmainargs", wgetmainargs);
    vm.register_import(DLL, "_configure_narrow_argv", configure_narrow_argv);
    vm.register_import(DLL, "_configure_wide_argv", configure_wide_argv);
    vm.register_import(DLL, "_CRT_RTC_INIT", crt_rtc_init);
    vm.register_import(DLL, "_CRT_RTC_INITW", crt_rtc_initw);
    vm.register_import(DLL, "__report_gsfailure", report_gsfailure);
    vm.register_import(DLL, "_get_osplatform", get_osplatform);
    vm.register_import(DLL, "_get_osver", get_osver);
    vm.register_import(DLL, "_get_winver", get_winver);
    vm.register_import(DLL, "_get_winmajor", get_winmajor);
    vm.register_import(DLL, "_get_winminor", get_winminor);
    vm.register_import(DLL, "__unDName", unDName);
    vm.register_import(DLL, "__unDNameEx", unDNameEx);
    vm.register_import(DLL, "__unDNameHelper", unDNameHelper);
}
